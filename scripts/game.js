!function t(e,n,r){function i(o,u){if(!n[o]){if(!e[o]){var l="function"==typeof require&&require;if(!u&&l)return l(o,!0);if(a)return a(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var c=n[o]={exports:{}};e[o][0].call(c.exports,function(t){var n=e[o][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e,n){(function(){var t=this,r=t._,i=Array.prototype,a=Object.prototype,o=Function.prototype,u=i.push,l=i.slice,s=i.concat,c=a.toString,f=a.hasOwnProperty,h=Array.isArray,p=Object.keys,d=o.bind,y=function(t){return t instanceof y?t:this instanceof y?void(this._wrapped=t):new y(t)};"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=y),n._=y):t._=y,y.VERSION="1.7.0";var v=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,a){return t.call(e,n,r,i,a)}}return function(){return t.apply(e,arguments)}};y.iteratee=function(t,e,n){return null==t?y.identity:y.isFunction(t)?v(t,e,n):y.isObject(t)?y.matches(t):y.property(t)},y.each=y.forEach=function(t,e,n){if(null==t)return t;e=v(e,n);var r,i=t.length;if(i===+i)for(r=0;i>r;r++)e(t[r],r,t);else{var a=y.keys(t);for(r=0,i=a.length;i>r;r++)e(t[a[r]],a[r],t)}return t},y.map=y.collect=function(t,e,n){if(null==t)return[];e=y.iteratee(e,n);for(var r,i=t.length!==+t.length&&y.keys(t),a=(i||t).length,o=Array(a),u=0;a>u;u++)r=i?i[u]:u,o[u]=e(t[r],r,t);return o};var g="Reduce of empty array with no initial value";y.reduce=y.foldl=y.inject=function(t,e,n,r){null==t&&(t=[]),e=v(e,r,4);var i,a=t.length!==+t.length&&y.keys(t),o=(a||t).length,u=0;if(arguments.length<3){if(!o)throw new TypeError(g);n=t[a?a[u++]:u++]}for(;o>u;u++)i=a?a[u]:u,n=e(n,t[i],i,t);return n},y.reduceRight=y.foldr=function(t,e,n,r){null==t&&(t=[]),e=v(e,r,4);var i,a=t.length!==+t.length&&y.keys(t),o=(a||t).length;if(arguments.length<3){if(!o)throw new TypeError(g);n=t[a?a[--o]:--o]}for(;o--;)i=a?a[o]:o,n=e(n,t[i],i,t);return n},y.find=y.detect=function(t,e,n){var r;return e=y.iteratee(e,n),y.some(t,function(t,n,i){return e(t,n,i)?(r=t,!0):void 0}),r},y.filter=y.select=function(t,e,n){var r=[];return null==t?r:(e=y.iteratee(e,n),y.each(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r)},y.reject=function(t,e,n){return y.filter(t,y.negate(y.iteratee(e)),n)},y.every=y.all=function(t,e,n){if(null==t)return!0;e=y.iteratee(e,n);var r,i,a=t.length!==+t.length&&y.keys(t),o=(a||t).length;for(r=0;o>r;r++)if(i=a?a[r]:r,!e(t[i],i,t))return!1;return!0},y.some=y.any=function(t,e,n){if(null==t)return!1;e=y.iteratee(e,n);var r,i,a=t.length!==+t.length&&y.keys(t),o=(a||t).length;for(r=0;o>r;r++)if(i=a?a[r]:r,e(t[i],i,t))return!0;return!1},y.contains=y.include=function(t,e){return null==t?!1:(t.length!==+t.length&&(t=y.values(t)),y.indexOf(t,e)>=0)},y.invoke=function(t,e){var n=l.call(arguments,2),r=y.isFunction(e);return y.map(t,function(t){return(r?e:t[e]).apply(t,n)})},y.pluck=function(t,e){return y.map(t,y.property(e))},y.where=function(t,e){return y.filter(t,y.matches(e))},y.findWhere=function(t,e){return y.find(t,y.matches(e))},y.max=function(t,e,n){var r,i,a=-(1/0),o=-(1/0);if(null==e&&null!=t){t=t.length===+t.length?t:y.values(t);for(var u=0,l=t.length;l>u;u++)r=t[u],r>a&&(a=r)}else e=y.iteratee(e,n),y.each(t,function(t,n,r){i=e(t,n,r),(i>o||i===-(1/0)&&a===-(1/0))&&(a=t,o=i)});return a},y.min=function(t,e,n){var r,i,a=1/0,o=1/0;if(null==e&&null!=t){t=t.length===+t.length?t:y.values(t);for(var u=0,l=t.length;l>u;u++)r=t[u],a>r&&(a=r)}else e=y.iteratee(e,n),y.each(t,function(t,n,r){i=e(t,n,r),(o>i||i===1/0&&a===1/0)&&(a=t,o=i)});return a},y.shuffle=function(t){for(var e,n=t&&t.length===+t.length?t:y.values(t),r=n.length,i=Array(r),a=0;r>a;a++)e=y.random(0,a),e!==a&&(i[a]=i[e]),i[e]=n[a];return i},y.sample=function(t,e,n){return null==e||n?(t.length!==+t.length&&(t=y.values(t)),t[y.random(t.length-1)]):y.shuffle(t).slice(0,Math.max(0,e))},y.sortBy=function(t,e,n){return e=y.iteratee(e,n),y.pluck(y.map(t,function(t,n,r){return{value:t,index:n,criteria:e(t,n,r)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return t.index-e.index}),"value")};var b=function(t){return function(e,n,r){var i={};return n=y.iteratee(n,r),y.each(e,function(r,a){var o=n(r,a,e);t(i,r,o)}),i}};y.groupBy=b(function(t,e,n){y.has(t,n)?t[n].push(e):t[n]=[e]}),y.indexBy=b(function(t,e,n){t[n]=e}),y.countBy=b(function(t,e,n){y.has(t,n)?t[n]++:t[n]=1}),y.sortedIndex=function(t,e,n,r){n=y.iteratee(n,r,1);for(var i=n(e),a=0,o=t.length;o>a;){var u=a+o>>>1;n(t[u])<i?a=u+1:o=u}return a},y.toArray=function(t){return t?y.isArray(t)?l.call(t):t.length===+t.length?y.map(t,y.identity):y.values(t):[]},y.size=function(t){return null==t?0:t.length===+t.length?t.length:y.keys(t).length},y.partition=function(t,e,n){e=y.iteratee(e,n);var r=[],i=[];return y.each(t,function(t,n,a){(e(t,n,a)?r:i).push(t)}),[r,i]},y.first=y.head=y.take=function(t,e,n){return null!=t?null==e||n?t[0]:0>e?[]:l.call(t,0,e):void 0},y.initial=function(t,e,n){return l.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},y.last=function(t,e,n){return null!=t?null==e||n?t[t.length-1]:l.call(t,Math.max(t.length-e,0)):void 0},y.rest=y.tail=y.drop=function(t,e,n){return l.call(t,null==e||n?1:e)},y.compact=function(t){return y.filter(t,y.identity)};var m=function(t,e,n,r){if(e&&y.every(t,y.isArray))return s.apply(r,t);for(var i=0,a=t.length;a>i;i++){var o=t[i];y.isArray(o)||y.isArguments(o)?e?u.apply(r,o):m(o,e,n,r):n||r.push(o)}return r};y.flatten=function(t,e){return m(t,e,!1,[])},y.without=function(t){return y.difference(t,l.call(arguments,1))},y.uniq=y.unique=function(t,e,n,r){if(null==t)return[];y.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=y.iteratee(n,r));for(var i=[],a=[],o=0,u=t.length;u>o;o++){var l=t[o];if(e)o&&a===l||i.push(l),a=l;else if(n){var s=n(l,o,t);y.indexOf(a,s)<0&&(a.push(s),i.push(l))}else y.indexOf(i,l)<0&&i.push(l)}return i},y.union=function(){return y.uniq(m(arguments,!0,!0,[]))},y.intersection=function(t){if(null==t)return[];for(var e=[],n=arguments.length,r=0,i=t.length;i>r;r++){var a=t[r];if(!y.contains(e,a)){for(var o=1;n>o&&y.contains(arguments[o],a);o++);o===n&&e.push(a)}}return e},y.difference=function(t){var e=m(l.call(arguments,1),!0,!0,[]);return y.filter(t,function(t){return!y.contains(e,t)})},y.zip=function(t){if(null==t)return[];for(var e=y.max(arguments,"length").length,n=Array(e),r=0;e>r;r++)n[r]=y.pluck(arguments,r);return n},y.object=function(t,e){if(null==t)return{};for(var n={},r=0,i=t.length;i>r;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},y.indexOf=function(t,e,n){if(null==t)return-1;var r=0,i=t.length;if(n){if("number"!=typeof n)return r=y.sortedIndex(t,e),t[r]===e?r:-1;r=0>n?Math.max(0,i+n):n}for(;i>r;r++)if(t[r]===e)return r;return-1},y.lastIndexOf=function(t,e,n){if(null==t)return-1;var r=t.length;for("number"==typeof n&&(r=0>n?r+n+1:Math.min(r,n+1));--r>=0;)if(t[r]===e)return r;return-1},y.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=n||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),a=0;r>a;a++,t+=n)i[a]=t;return i};var w=function(){};y.bind=function(t,e){var n,r;if(d&&t.bind===d)return d.apply(t,l.call(arguments,1));if(!y.isFunction(t))throw new TypeError("Bind must be called on a function");return n=l.call(arguments,2),r=function(){if(!(this instanceof r))return t.apply(e,n.concat(l.call(arguments)));w.prototype=t.prototype;var i=new w;w.prototype=null;var a=t.apply(i,n.concat(l.call(arguments)));return y.isObject(a)?a:i}},y.partial=function(t){var e=l.call(arguments,1);return function(){for(var n=0,r=e.slice(),i=0,a=r.length;a>i;i++)r[i]===y&&(r[i]=arguments[n++]);for(;n<arguments.length;)r.push(arguments[n++]);return t.apply(this,r)}},y.bindAll=function(t){var e,n,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(e=1;r>e;e++)n=arguments[e],t[n]=y.bind(t[n],t);return t},y.memoize=function(t,e){var n=function(r){var i=n.cache,a=e?e.apply(this,arguments):r;return y.has(i,a)||(i[a]=t.apply(this,arguments)),i[a]};return n.cache={},n},y.delay=function(t,e){var n=l.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},y.defer=function(t){return y.delay.apply(y,[t,1].concat(l.call(arguments,1)))},y.throttle=function(t,e,n){var r,i,a,o=null,u=0;n||(n={});var l=function(){u=n.leading===!1?0:y.now(),o=null,a=t.apply(r,i),o||(r=i=null)};return function(){var s=y.now();u||n.leading!==!1||(u=s);var c=e-(s-u);return r=this,i=arguments,0>=c||c>e?(clearTimeout(o),o=null,u=s,a=t.apply(r,i),o||(r=i=null)):o||n.trailing===!1||(o=setTimeout(l,c)),a}},y.debounce=function(t,e,n){var r,i,a,o,u,l=function(){var s=y.now()-o;e>s&&s>0?r=setTimeout(l,e-s):(r=null,n||(u=t.apply(a,i),r||(a=i=null)))};return function(){a=this,i=arguments,o=y.now();var s=n&&!r;return r||(r=setTimeout(l,e)),s&&(u=t.apply(a,i),a=i=null),u}},y.wrap=function(t,e){return y.partial(e,t)},y.negate=function(t){return function(){return!t.apply(this,arguments)}},y.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},y.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},y.before=function(t,e){var n;return function(){return--t>0?n=e.apply(this,arguments):e=null,n}},y.once=y.partial(y.before,2),y.keys=function(t){if(!y.isObject(t))return[];if(p)return p(t);var e=[];for(var n in t)y.has(t,n)&&e.push(n);return e},y.values=function(t){for(var e=y.keys(t),n=e.length,r=Array(n),i=0;n>i;i++)r[i]=t[e[i]];return r},y.pairs=function(t){for(var e=y.keys(t),n=e.length,r=Array(n),i=0;n>i;i++)r[i]=[e[i],t[e[i]]];return r},y.invert=function(t){for(var e={},n=y.keys(t),r=0,i=n.length;i>r;r++)e[t[n[r]]]=n[r];return e},y.functions=y.methods=function(t){var e=[];for(var n in t)y.isFunction(t[n])&&e.push(n);return e.sort()},y.extend=function(t){if(!y.isObject(t))return t;for(var e,n,r=1,i=arguments.length;i>r;r++){e=arguments[r];for(n in e)f.call(e,n)&&(t[n]=e[n])}return t},y.pick=function(t,e,n){var r,i={};if(null==t)return i;if(y.isFunction(e)){e=v(e,n);for(r in t){var a=t[r];e(a,r,t)&&(i[r]=a)}}else{var o=s.apply([],l.call(arguments,1));t=new Object(t);for(var u=0,c=o.length;c>u;u++)r=o[u],r in t&&(i[r]=t[r])}return i},y.omit=function(t,e,n){if(y.isFunction(e))e=y.negate(e);else{var r=y.map(s.apply([],l.call(arguments,1)),String);e=function(t,e){return!y.contains(r,e)}}return y.pick(t,e,n)},y.defaults=function(t){if(!y.isObject(t))return t;for(var e=1,n=arguments.length;n>e;e++){var r=arguments[e];for(var i in r)void 0===t[i]&&(t[i]=r[i])}return t},y.clone=function(t){return y.isObject(t)?y.isArray(t)?t.slice():y.extend({},t):t},y.tap=function(t,e){return e(t),t};var S=function(t,e,n,r){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof y&&(t=t._wrapped),e instanceof y&&(e=e._wrapped);var i=c.call(t);if(i!==c.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}if("object"!=typeof t||"object"!=typeof e)return!1;for(var a=n.length;a--;)if(n[a]===t)return r[a]===e;var o=t.constructor,u=e.constructor;if(o!==u&&"constructor"in t&&"constructor"in e&&!(y.isFunction(o)&&o instanceof o&&y.isFunction(u)&&u instanceof u))return!1;n.push(t),r.push(e);var l,s;if("[object Array]"===i){if(l=t.length,s=l===e.length)for(;l--&&(s=S(t[l],e[l],n,r)););}else{var f,h=y.keys(t);if(l=h.length,s=y.keys(e).length===l)for(;l--&&(f=h[l],s=y.has(e,f)&&S(t[f],e[f],n,r)););}return n.pop(),r.pop(),s};y.isEqual=function(t,e){return S(t,e,[],[])},y.isEmpty=function(t){if(null==t)return!0;if(y.isArray(t)||y.isString(t)||y.isArguments(t))return 0===t.length;for(var e in t)if(y.has(t,e))return!1;return!0},y.isElement=function(t){return!(!t||1!==t.nodeType)},y.isArray=h||function(t){return"[object Array]"===c.call(t)},y.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},y.each(["Arguments","Function","String","Number","Date","RegExp"],function(t){y["is"+t]=function(e){return c.call(e)==="[object "+t+"]"}}),y.isArguments(arguments)||(y.isArguments=function(t){return y.has(t,"callee")}),"function"!=typeof/./&&(y.isFunction=function(t){return"function"==typeof t||!1}),y.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},y.isNaN=function(t){return y.isNumber(t)&&t!==+t},y.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===c.call(t)},y.isNull=function(t){return null===t},y.isUndefined=function(t){return void 0===t},y.has=function(t,e){return null!=t&&f.call(t,e)},y.noConflict=function(){return t._=r,this},y.identity=function(t){return t},y.constant=function(t){return function(){return t}},y.noop=function(){},y.property=function(t){return function(e){return e[t]}},y.matches=function(t){var e=y.pairs(t),n=e.length;return function(t){if(null==t)return!n;t=new Object(t);for(var r=0;n>r;r++){var i=e[r],a=i[0];if(i[1]!==t[a]||!(a in t))return!1}return!0}},y.times=function(t,e,n){var r=Array(Math.max(0,t));e=v(e,n,1);for(var i=0;t>i;i++)r[i]=e(i);return r},y.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},y.now=Date.now||function(){return(new Date).getTime()};var P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},j=y.invert(P),O=function(t){var e=function(e){return t[e]},n="(?:"+y.keys(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}};y.escape=O(P),y.unescape=O(j),y.result=function(t,e){if(null!=t){var n=t[e];return y.isFunction(n)?t[e]():n}};var _=0;y.uniqueId=function(t){var e=++_+"";return t?t+e:e},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var k=/(.)^/,x={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},T=/\\|'|\r|\n|\u2028|\u2029/g,A=function(t){return"\\"+x[t]};y.template=function(t,e,n){!e&&n&&(e=n),e=y.defaults({},e,y.templateSettings);var r=RegExp([(e.escape||k).source,(e.interpolate||k).source,(e.evaluate||k).source].join("|")+"|$","g"),i=0,a="__p+='";t.replace(r,function(e,n,r,o,u){return a+=t.slice(i,u).replace(T,A),i=u+e.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?a+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(a+="';\n"+o+"\n__p+='"),e}),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var o=new Function(e.variable||"obj","_",a)}catch(u){throw u.source=a,u}var l=function(t){return o.call(this,t,y)},s=e.variable||"obj";return l.source="function("+s+"){\n"+a+"}",l},y.chain=function(t){var e=y(t);return e._chain=!0,e};var C=function(t){return this._chain?y(t).chain():t};y.mixin=function(t){y.each(y.functions(t),function(e){var n=y[e]=t[e];y.prototype[e]=function(){var t=[this._wrapped];return u.apply(t,arguments),C.call(this,n.apply(y,t))}})},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];y.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],C.call(this,n)}}),y.each(["concat","join","slice"],function(t){var e=i[t];y.prototype[t]=function(){return C.call(this,e.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return y})}).call(this)},{}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={};n["default"]=r;var i=function(t,e){for(var n in t)e[n]=t[n]},a=(n.configForPlayers=function(t){t>=4?i(a,r):3==t?i(o,r):i(u,r),console.log("init consts",r)},{Size:32,StartHealth:64,SizeX:14,SizeY:9,ScaleX:2,ScaleY:2,StartingPositions:[{x:2,y:2},{x:12,y:7},{x:12,y:2},{x:2,y:7}]}),o=(n.Colors=[{colorStr:"#12fe00",colorNum:1244672},{colorStr:"#fff859",colorNum:16775257},{colorStr:"#0decfe",colorNum:912638},{colorStr:"#fe544f",colorNum:16667727}],{Size:32,StartHealth:64,SizeX:11,SizeY:9,ScaleX:2,ScaleY:2,StartingPositions:[{x:1,y:4},{x:6,y:4},{x:9,y:4}]}),u={Size:32,StartHealth:64,SizeX:9,SizeY:7,ScaleX:2,ScaleY:2,StartingPositions:[{x:1,y:3},{x:8,y:3}]}},{}],3:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=t("states/GameState"),s=r(l),c=t("states/MenuState"),f=r(c),h=t("states/LoadingScreen"),p=r(h),d=t("states/EndState"),y=r(d),v=(t("underscore"),function(t){function e(){i(this,e);var t=a(this,Object.getPrototypeOf(e).call(this,960,640,Phaser.AUTO,"content",null,!1,!1));return t.state.add("LoadingScreen",p["default"],!1),t.state.add("MenuState",f["default"],!1),t.state.add("GameState",s["default"],!1),t.state.add("EndState",y["default"],!1),t.players=[],t.state.start("LoadingScreen"),t}return o(e,t),u(e,[{key:"create",value:function(){console.log("game create"),this.stage.backgroundColor="#ff00ff"}}]),e}(Phaser.Game));new v},{"states/EndState":11,"states/GameState":12,"states/LoadingScreen":13,"states/MenuState":14,underscore:1}],4:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t){function e(t,n,a,o,u,l,s,c,f){r(this,e);var h=i(this,Object.getPrototypeOf(e).call(this,t,n,a,o,u,l,s,c,f));return t.add.existing(h),h}return a(e,t),o(e,[{key:"addText",value:function(t,e){var n=new Phaser.Text(this.game,0,0,t,{font:e+"px Arial",fill:"#ffffff"});this.addChild(n)}}]),e}(Phaser.Button);n["default"]=u},{}],5:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=t("objects/Tile.js"),s=r(l),c=function(t){function e(t,n,r){i(this,e);var o=a(this,Object.getPrototypeOf(e).call(this,t));o.xSize=n,o.ySize=r;var u=0;return o.mapData=Array.apply(null,Array(n*r)).map(function(e){var r=new s["default"](t,u%n,Math.floor(u/n));return u++,r}),console.log(o.mapData),o.mapData.forEach(function(t){o.addChild(t)}),o}return o(e,t),u(e,[{key:"tileAt",value:function(t,e){return this.mapData[e*this.xSize+t]}},{key:"increaseScores",value:function(){for(var t=0;t<this.mapData.length;++t){var e=this.mapData[t];e.isFree()||e.grow(1)}}},{key:"scores",value:function(){for(var t=new Map,e=0;e<this.mapData.length;++e){var n=this.mapData[e];if(!n.isFree()){var r=n.player,i=t.get(r)+n.health||n.health;t.set(r,i)}}return t}}]),e}(Phaser.Group);n["default"]=c},{"objects/Tile.js":9}],6:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(t){function e(t,n,a){return r(this,e),i(this,Object.getPrototypeOf(e).call(this,t))}return a(e,t),e}(Phaser.Stage);n["default"]=o},{}],7:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.PlayerInfo=void 0;var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=t("consts/MapConsts.js"),s=r(l),c=(n.PlayerInfo=function(){function t(e,n,r){o(this,t),this.padId=e,this.id=n,this.padMap=r}return u(t,[{key:"color",get:function(){return this.colorNum}},{key:"colorNum",get:function(){return l.Colors[this.id].colorNum}},{key:"colorStr",get:function(){return l.Colors[this.id].colorStr}}]),t}(),function(t){function e(t,n,r,a,u){o(this,e);var l=i(this,Object.getPrototypeOf(e).call(this,t));return l.callbacks=u||{},l.callbacks.doDivide||(l.callbacks.doDivide=function(t,e,n){}),l.callbacks.context||(l.callbacks.context={}),l.info=n,l.tilePosX=r,l.tilePosY=a,l.updateSprites(),l.sprite=new Phaser.Sprite(t,0,0,"cursor"),l.sprite.tint=n.color,l.sprite.animations.add("cycle"),l.sprite.animations.play("cycle",8,!0),l.addChild(l.sprite),l.pad.addCallbacks(l,{onDown:l.handlePadDown,onUp:l.handlePadUp}),l.actionPressed=!1,l.moveActions={up:l.moveUp,down:l.moveDown,left:l.moveLeft,right:l.moveRight},l.divideActions={up:l.divideUp,down:l.divideDown,left:l.divideLeft,right:l.divideRight},l}return a(e,t),u(e,[{key:"handlePadDown",value:function(t){var e=this.info.padMap[t];if(console.log("button pressed",e,"action pressed:"+this.actionPressed),"action"==e&&(this.actionPressed=!0),"dash"==e&&(this.dashPressed=!0),this.moveActions[e]){if(this.dashPressed)return this.divideActions[e].call(this),void this.moveActions[e].call(this);this.actionPressed?this.divideActions[e].call(this):this.moveActions[e].call(this)}}},{key:"handlePadUp",value:function(t){var e=this.info.padMap[t];"action"==e&&(this.actionPressed=!1),"dash"==e&&(this.dashPressed=!1)}},{key:"moveUp",value:function(){var t=this;console.log("UP!");var e=this.game.add.tween(this).to({y:(s["default"].SizeY+this.tilePosY-1)%s["default"].SizeY*s["default"].Size},50,"Linear",!0,0);e.onComplete.add(function(){t.tilePosY=(s["default"].SizeY+t.tilePosY-1)%s["default"].SizeY},this)}},{key:"moveDown",value:function(){var t=this,e=this.game.add.tween(this).to({y:(s["default"].SizeY+this.tilePosY+1)%s["default"].SizeY*s["default"].Size},50,"Linear",!0,0);e.onComplete.add(function(){t.tilePosY=(s["default"].SizeY+t.tilePosY+1)%s["default"].SizeY},this)}},{key:"moveLeft",value:function(){var t=this,e=this.game.add.tween(this).to({x:(s["default"].SizeX+this.tilePosX-1)%s["default"].SizeX*s["default"].Size},50,"Linear",!0,0);e.onComplete.add(function(){t.tilePosX=(s["default"].SizeX+t.tilePosX-1)%s["default"].SizeX},this)}},{key:"moveRight",value:function(){var t=this,e=this.game.add.tween(this).to({x:(s["default"].SizeX+this.tilePosX+1)%s["default"].SizeX*s["default"].Size},50,"Linear",!0,0);e.onComplete.add(function(){t.tilePosX=(s["default"].SizeX+t.tilePosX+1)%s["default"].SizeX},this)}},{key:"divideTo",value:function(t,e){console.log("divide"),this.callbacks.doDivide.call(this.callbacks.context,this,t,e)}},{key:"divideUp",value:function(){var t=this.tilePosX,e=this.tilePosY-1;e>=0&&this.divideTo(t,e)}},{key:"divideDown",value:function(){var t=this.tilePosX,e=this.tilePosY+1;e<s["default"].SizeY&&this.divideTo(t,e)}},{key:"divideLeft",value:function(){var t=this.tilePosX-1,e=this.tilePosY;t>=0&&this.divideTo(t,e)}},{key:"divideRight",value:function(){var t=this.tilePosX+1,e=this.tilePosY;t<s["default"].SizeX&&this.divideTo(t,e)}},{key:"ownsTile",value:function(t){return t.player===this}},{key:"updateSprites",value:function(){this.position.set(this.tilePosX*s["default"].Size,this.tilePosY*s["default"].Size)}},{key:"update",value:function(){}},{key:"pad",get:function(){return this.game.input.gamepad[this.info.padId]}}]),e}(Phaser.Group));n["default"]=c},{"consts/MapConsts.js":2}],8:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=t("consts/MapConsts"),s=(r(l),function(t){function e(t,n,r,o){i(this,e);var u=a(this,Object.getPrototypeOf(e).call(this,t));u.sprite=new Phaser.Sprite(t,n,r,o),t.add.existing(u);var s=u.game.add.bitmapText(142,12,"font","0",24);u.addChildAt(s,0);var c=u.game.add.bitmapText(302,12,"font","0",24);u.addChildAt(c,1);var f=u.game.add.bitmapText(558,12,"font","0",24);u.addChildAt(f,2);var h=u.game.add.bitmapText(718,12,"font","0",24);u.addChildAt(h,3);var p=new Phaser.Sprite(t,190,6,"pad");p.tint=l.Colors[0].colorNum,u.addChild(p,4);var d=new Phaser.Sprite(t,350,6,"pad");d.tint=l.Colors[1].colorNum,u.addChild(d,5);var y=new Phaser.Sprite(t,606,6,"pad");y.tint=l.Colors[2].colorNum,u.addChild(y,6);var v=new Phaser.Sprite(t,766,6,"pad");return v.tint=l.Colors[3].colorNum,u.addChild(v,7),u}return o(e,t),u(e,[{key:"changeScore",value:function(t,e){if(0===t){var n=this.getChildAt(0);n.text=e,this.removeChildAt(0),this.addChildAt(n,0)}if(1===t){var r=this.getChildAt(1);r.text=e,this.removeChildAt(1),this.addChildAt(r,1)}if(2===t){var i=this.getChildAt(2);i.text=e,this.removeChildAt(2),this.addChildAt(i,2)}if(3===t){var a=this.getChildAt(3);a.text=e,this.removeChildAt(3),this.addChildAt(a,3)}}}]),e}(Phaser.Sprite));n["default"]=s},{"consts/MapConsts":2}],9:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=t("consts/MapConsts"),s=r(l),c=function(t){function e(t,n,r){i(this,e);var o=a(this,Object.getPrototypeOf(e).call(this,t));return o.sprite=new Phaser.Sprite(o.game,n*s["default"].Size,r*s["default"].Size,"tile"),o.addChild(o.sprite),o.healthText=new Phaser.BitmapText(o.game,4,8,"font","",16),o.sprite.addChild(o.healthText),o.player=null,o.health=0,o.updateSprite(),o}return o(e,t),u(e,[{key:"isHabitable",value:function(){return!0}},{key:"isFree",value:function(){return null==this.player}},{key:"populate",value:function(t,e){t!=this.player&&(this.health=0),this.player=t,this.health+=e,this.updateSprite()}},{key:"grow",value:function(t){null!=this.player&&(this.health+=t,this.updateSprite())}},{key:"depopulate",value:function(t){this.health=Math.max(0,this.health-t),0===this.health&&(this.player=null),this.updateSprite()}},{key:"updateSprite",value:function(){null!==this.player&&(this.sprite.tint=this.player.info.colorNum,this.healthText.text=this.health)}}]),e}(Phaser.Group);n["default"]=c},{"consts/MapConsts":2}],10:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t){function e(t,n,a,o){r(this,e);var u=i(this,Object.getPrototypeOf(e).call(this,t));u.sprite=new Phaser.Sprite(t,n,a,o),t.add.existing(u);var l=u.game.add.bitmapText(456,8,"font","99",38);return u.addChild(l),u}return a(e,t),o(e,[{key:"changeTimer",value:function(t){this.removeChildren();var e=this.game.add.bitmapText(456,8,"font",t,38);
this.addChild(e)}}]),e}(Phaser.Sprite);n["default"]=u},{}],11:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(l){i=!0,a=l}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return a(e,t),u(e,[{key:"setScore",value:function(t){this.score=t}},{key:"create",value:function(){void 0===this.score&&(this.score=new Map,this.score.set({info:{id:0,colorStr:"#12fe00"}},200),this.score.set({info:{id:1,colorStr:"#fff859"}},200),this.score.set({info:{id:2,colorStr:"#0decfe"}},200),this.score.set({info:{id:3,colorStr:"#fe544f"}},200)),console.log("EndState:"),this.game.add.sprite(0,0,"bgEnd");var t={x:this.game.world.centerX,y:this.game.world.centerY},e=Math.max.apply(null,Array.from(this.score.values()));console.log(e);var n=Array.prototype.filter.call(Array.from(this.score.entries()),function(t){var n=o(t,2),r=(n[0],n[1]);return r==e});this.game.input.gamepad.start(),this.game.input.gamepad.addCallbacks(this,{onDown:this.padDownEvent});var r=1;this.game.add.bitmapText(t.x-135,t.y-245,"font","WINNERS:",60);var i=!0,a=!1,u=void 0;try{for(var l,s=n[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var c=o(l.value,2),f=c[0],h=c[1],p=this.game.add.bitmapText(t.x-350,t.y-195+70*r,"font","Player "+(f.info.id+1)+" score: "+h,48);p.tint="0x"+f.info.colorStr.replace("#",""),r++}}catch(d){a=!0,u=d}finally{try{!i&&s["return"]&&s["return"]()}finally{if(a)throw u}}this.game.add.bitmapText(t.x-350,t.y+200,"font","Player 1 hit match button to replay!",36);for(var y=Array.from(this.score.keys()),v=0;v<y.length;v++)0===y[v].info.id&&(this.firstPad=y[v].info.padId,this.firstPadMap=y[v].info.padMap)}},{key:"rematch",value:function(){window.location.reload(!1)}},{key:"padDownEvent",value:function(t){var e=this,n=this.game.input.gamepad[this.firstPad];n.addCallbacks(this,{onDown:function(t){"action"===e.firstPadMap[t]&&e.rematch()}})}}]),e}(Phaser.State);n["default"]=l},{}],12:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=t("objects/Grid"),s=(r(l),t("consts/MapConsts")),c=r(s),f=t("objects/GameMap"),h=r(f),p=t("objects/ScoreTable"),d=r(p),y=t("objects/Player"),v=r(y),g=t("objects/Timer"),b=r(g),m=function(t){function e(){return i(this,e),a(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"create",value:function(){(0,s.configForPlayers)(this.game.players.length),this.game.add.image(0,0,"bgFrame"),this.playerObjects=[],this.countdown=99,this.createMap();for(var t=0;t<this.game.players.length;++t)this.addPlayerByInfo(this.game.players[t]);this.timerLabel=new b["default"](this.game,200,200,"timer"),this.timerStart(),this.scoreTable=new d["default"](this.game,300,300,"scoreTable"),this.attackSound=this.game.add.audio("attackSound"),this.divideSound=this.game.add.audio("divideSound")}},{key:"createMap",value:function(){this.mapa=new h["default"](this.game,c["default"].SizeX,c["default"].SizeY),this.mapa.scale.set(2,2),this.mapa.x+=32,this.mapa.y+=54}},{key:"addPlayerByInfo",value:function(t){var e=this,n=t.id,r=c["default"].StartingPositions[n],i=new v["default"](this.game,t,r.x,r.y,{doDivide:function(t,n,r){e.divideInto(t,n,r)}}),a=this.playerTile(i);this.mapa.addChild(i),a.populate(i,c["default"].StartHealth),this.playerObjects.push(i)}},{key:"timerStart",value:function(){var t=this.game.time.create(!1);t.loop(1e3,this.updateTimer,this),t.start()}},{key:"updateTimer",value:function(){this.countdown--,console.log("Timer: "+this.countdown),this.timerLabel.changeTimer(this.countdown);for(var t=this.mapa.scores(),e=Array.from(t.values()),n=0;n<e.length;n++)this.scoreTable.changeScore(n,e[n]);0!=this.countdown&&1!=Array.from(t.entries()).length||this.finishGame(t),this.countdown&&this.countdown%5==0&&this.mapa.increaseScores()}},{key:"finishGame",value:function(t){this.game.state.states.EndState.setScore(t),this.game.state.start("EndState")}},{key:"tileAt",value:function(t,e){return this.mapa.tileAt(t,e)}},{key:"playerTile",value:function(t){return this.tileAt(t.tilePosX,t.tilePosY)}},{key:"playersScore",value:function(){return this.mapa.scores()}},{key:"divideInto",value:function(t,e,n){console.log("divide start");var r=this.playerTile(t);if(r.player===t){var i=this.tileAt(e,n);if(i.isHabitable()){var a=Math.floor(r.health/2);if(0!=a)if(console.log("divide:",a),i.isFree()||t.ownsTile(i))r.depopulate(a),i.populate(t,a),this.playDivideSound();else{var o=Math.min(i.health,a);r.depopulate(a),i.depopulate(o);var u=a-Math.ceil(o/2);u>0&&i.populate(t,u),this.playAttackSound()}}}}},{key:"playDivideSound",value:function(){this.divideSound.play()}},{key:"playAttackSound",value:function(){this.attackSound.play()}}]),e}(Phaser.State);n["default"]=m},{"consts/MapConsts":2,"objects/GameMap":5,"objects/Grid":6,"objects/Player":7,"objects/ScoreTable":8,"objects/Timer":10}],13:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return a(e,t),o(e,[{key:"preload",value:function(){this.barLoaded=!1,this.load.image("loading-logo","assets/loading/load-logo.png"),this.load.image("loading-bar","assets/loading/bar.png"),this.load.addSyncPoint("image","loading-bar"),this.load.onFileComplete.add(this.afterLoaded,this),this.load.image("loading-2","assets/loading/2.png"),this.game.load.tilemap("myTileMap","assets/level11.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.image("tiles","assets/tileset.png"),this.game.load.image("tile","assets/tile.png"),this.load.spritesheet("cursor","assets/cursor.png",32,32,4),this.load.bitmapFont("font","assets/04B_03___0.png","assets/04B_03__.xml"),this.game.load.audio("themeAudio","assets/audio/themeAudio.mp3"),this.game.load.audio("attackSound","assets/audio/attackSound.wav"),this.game.load.audio("divideSound","assets/audio/divideSound.wav"),this.game.load.audio("powerUpSound","assets/audio/powerUpSound.wav"),this.game.load.spritesheet("colorButtons","assets/colorButtonSpritesheet.png",64,64),this.game.load.spritesheet("startGameSpritesheet","assets/startGameSpritesheet.png",248,64),this.game.load.image("bg","assets/bgEnd.png"),this.game.load.image("bgFrame","assets/bgFrame.png"),this.load.image("bgEnd","assets/bgEnd.png"),this.game.load.image("pad","assets/pad.png")}},{key:"afterLoaded",value:function(){var t={"loading-logo":this.afterLogoLoaded,"loading-bar":this.afterBarLoaded};t[arguments[1]]&&t[arguments[1]].call(this)}},{key:"afterLogoLoaded",value:function(){this.logo=this.game.add.image(this.game.width/2,this.game.height/2,"loading-logo"),this.logo.anchor.setTo(.5)}},{key:"afterBarLoaded",value:function(){this.origWidth=this.cache.getImage("loading-bar").width,this.bar=this.game.add.image(this.game.width/2-this.origWidth/2,this.game.height/2+this.logo.height,"loading-bar"),this.cropRect=new Phaser.Rectangle(0,0,0,this.bar.height),this.bar.crop(this.cropRect),this.barLoaded=!0}},{key:"loadUpdate",value:function(){this.barLoaded&&this.barUpdate(this.load.progress)}},{key:"barUpdate",value:function(t){this.cropRect.width=t*this.origWidth/100,this.bar.crop(this.cropRect)}},{key:"create",value:function(){var t=this.game.add.audio("themeAudio");t.loopFull(.6),this.barUpdate(100),this.state.start("MenuState")}}]),e}(Phaser.State);n["default"]=u},{}],14:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=t("objects/Button"),s=(r(l),t("objects/Player")),c=(r(s),function(t){function e(){return i(this,e),a(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"create",value:function(){var t=this;this.game.add.image(0,0,"bg");var e={x:this.game.world.centerX,y:this.game.world.centerY};this.game.add.button(e.x-32,e.y+225,"colorButtons",function(){t.clearSettings(),t.saveSettings()},this,2,2,1,2);this.playersColors=["0x12fe00","0xfff859","0x0decfe","0xfe544f"],this.buttons=["any","up","down","left","right","action","dash"],this.playerText={},this.isActive=[!1,!1,!1,!1],this.game.input.gamepad.start(),this.game.input.gamepad.addCallbacks(this,{onDown:this.padDownEvent});var n=this.game.add.bitmapText(this.game.world.centerX,48,"font","Total",72);n.anchor.setTo(.5);var r=this.game.add.bitmapText(this.game.world.centerX,116,"font","Kwadracik",72);r.anchor.setTo(.5);var i=this.game.add.bitmapText(this.game.world.centerX,184,"font","Anihillation",72);i.anchor.setTo(.5),this.clearSettings(),this.loadSettings()}},{key:"update",value:function(){}},{key:"playerInfoArray",value:function(){for(var t=[],e=0;e<this.playerz.length;++e)this.isActive[e]&&t.push(this.playerz[e]);return t}},{key:"playerSettingsArray",value:function(){for(var t=[],e=0;e<this.playerz.length;++e)this.playerButtonId[e]==this.buttons.length&&t.push(this.playerz[e]);return t}},{key:"saveSettings",value:function(){"undefined"!=typeof Storage&&(localStorage.setItem("players",JSON.stringify(this.playerSettingsArray())),console.log("Saved players:"),console.log(this.playerSettingsArray()))}},{key:"loadSettings",value:function(){if("undefined"!=typeof Storage){this.playerz.length=0;var t=JSON.parse(localStorage.getItem("players"));if(null!=t){for(var e=0;e<t.length;++e)t[e].id=e,this.playerButtonId[e]=this.buttons.length,this.playerNums++,this.playerz[e]=new s.PlayerInfo(t[e].padId,t[e].id,t[e].padMap),this.registerButtonCallback(t[e],e);console.log("Loaded players."),console.log(this.playerSettingsArray())}}}},{key:"clearSettings",value:function(){this.playerz=[],this.playerNums=0,this.playerButtonId={},this.playerButtons=[];for(var t=0;4>t;++t){var e=this.playersColors[t];void 0===this.playerText[t]?(this.playerText[t]=this.game.add.bitmapText(128,266+70*t,"font","player"+(t+1)+" - press any button to join",32),this.playerText[t].tint=e):this.playerText[t].text="player"+(t+1)+" - press any button to join",this.playerButtons[t]=this.add.sprite(32,250+70*t,"colorButtons",2),this.playerButtons[t].tint=e}this.clearCallbacks()}},{key:"clearCallbacks",value:function(){for(var t=0;t<this.playerz.length;++t){var e=this.game.input.gamepad[this.playerz[t].padId];e&&(e.onDownCallback=null)}}},{key:"addPlayer",value:function(t){console.log("pad connected ",t)}},{key:"registerButtonCallback",value:function(t,e){var n=this,r=this.game.input.gamepad[t.padId];r.addCallbacks(this,{onDown:function(r){if(n.playerButtonId[e]<n.buttons.length){var i=n.buttons[n.playerButtonId[e]];if("any"!==i){if(t.padMap[r])return;t.padMap[r]=i}n.playerButtonId[e]++,n.playerButtonId[e]>=n.buttons.length?n.playerText[e].text="ready?":n.playerText[e].text=n.buttons[n.playerButtonId[e]]}else 0==e&&n.isActive[0]?(n.clearCallbacks(),n.game.players=n.playerInfoArray(),n.game.state.start("GameState")):n.isActive[e]||(n.playerText[e].text=0==e?"press 'action' to begin":"ready!",n.isActive[e]=!0,n.playerButtons[e].frame=1,n.saveSettings());console.log(t.padMap)}})}},{key:"padDownEvent",value:function(t,e,n){for(var r="pad"+(n+1),i=0;i<this.playerz.length;++i)if(this.playerz[i].padId==r)return;console.log("new player");var a=this.playerNums;this.playerz[a]=new s.PlayerInfo(r,a,{}),this.playerButtonId[a]=0,this.playerNums++,this.registerButtonCallback(this.playerz[a],a)}}]),e}(Phaser.State));n["default"]=c},{"objects/Button":4,"objects/Player":7}]},{},[3]);