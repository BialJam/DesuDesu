!function t(e,n,r){function i(a,u){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){(function(){function t(t){function e(e,n,r,i,o,a){for(;o>=0&&a>o;o+=t){var u=i?i[o]:o;r=n(r,e[u],u,e)}return r}return function(n,r,i,o){r=S(r,o,4);var a=!T(n)&&w.keys(n),u=(a||n).length,s=t>0?0:u-1;return arguments.length<3&&(i=n[a?a[s]:s],s+=t),e(n,r,i,a,s,u)}}function r(t){return function(e,n,r){n=j(n,r);for(var i=x(e),o=t>0?0:i-1;o>=0&&i>o;o+=t)if(n(e[o],o,e))return o;return-1}}function i(t,e,n){return function(r,i,o){var a=0,u=x(r);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+u,a):u=o>=0?Math.min(o+1,u):o+u+1;else if(n&&o&&u)return o=n(r,i),r[o]===i?o:-1;if(i!==i)return o=e(p.call(r,a,u),w.isNaN),o>=0?o+a:-1;for(o=t>0?a:u-1;o>=0&&u>o;o+=t)if(r[o]===i)return o;return-1}}function o(t,e){var n=z.length,r=t.constructor,i=w.isFunction(r)&&r.prototype||l,o="constructor";for(w.has(t,o)&&!w.contains(e,o)&&e.push(o);n--;)o=z[n],o in t&&t[o]!==i[o]&&!w.contains(e,o)&&e.push(o)}var a=this,u=a._,s=Array.prototype,l=Object.prototype,c=Function.prototype,f=s.push,p=s.slice,h=l.toString,d=l.hasOwnProperty,y=Array.isArray,v=Object.keys,g=c.bind,b=Object.create,m=function(){},w=function(t){return t instanceof w?t:this instanceof w?void(this._wrapped=t):new w(t)};"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=w),n._=w):a._=w,w.VERSION="1.8.3";var S=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return function(){return t.apply(e,arguments)}},j=function(t,e,n){return null==t?w.identity:w.isFunction(t)?S(t,e,n):w.isObject(t)?w.matcher(t):w.property(t)};w.iteratee=function(t,e){return j(t,e,1/0)};var O=function(t,e){return function(n){var r=arguments.length;if(2>r||null==n)return n;for(var i=1;r>i;i++)for(var o=arguments[i],a=t(o),u=a.length,s=0;u>s;s++){var l=a[s];e&&void 0!==n[l]||(n[l]=o[l])}return n}},P=function(t){if(!w.isObject(t))return{};if(b)return b(t);m.prototype=t;var e=new m;return m.prototype=null,e},_=function(t){return function(e){return null==e?void 0:e[t]}},k=Math.pow(2,53)-1,x=_("length"),T=function(t){var e=x(t);return"number"==typeof e&&e>=0&&k>=e};w.each=w.forEach=function(t,e,n){e=S(e,n);var r,i;if(T(t))for(r=0,i=t.length;i>r;r++)e(t[r],r,t);else{var o=w.keys(t);for(r=0,i=o.length;i>r;r++)e(t[o[r]],o[r],t)}return t},w.map=w.collect=function(t,e,n){e=j(e,n);for(var r=!T(t)&&w.keys(t),i=(r||t).length,o=Array(i),a=0;i>a;a++){var u=r?r[a]:a;o[a]=e(t[u],u,t)}return o},w.reduce=w.foldl=w.inject=t(1),w.reduceRight=w.foldr=t(-1),w.find=w.detect=function(t,e,n){var r;return r=T(t)?w.findIndex(t,e,n):w.findKey(t,e,n),void 0!==r&&-1!==r?t[r]:void 0},w.filter=w.select=function(t,e,n){var r=[];return e=j(e,n),w.each(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r},w.reject=function(t,e,n){return w.filter(t,w.negate(j(e)),n)},w.every=w.all=function(t,e,n){e=j(e,n);for(var r=!T(t)&&w.keys(t),i=(r||t).length,o=0;i>o;o++){var a=r?r[o]:o;if(!e(t[a],a,t))return!1}return!0},w.some=w.any=function(t,e,n){e=j(e,n);for(var r=!T(t)&&w.keys(t),i=(r||t).length,o=0;i>o;o++){var a=r?r[o]:o;if(e(t[a],a,t))return!0}return!1},w.contains=w.includes=w.include=function(t,e,n,r){return T(t)||(t=w.values(t)),("number"!=typeof n||r)&&(n=0),w.indexOf(t,e,n)>=0},w.invoke=function(t,e){var n=p.call(arguments,2),r=w.isFunction(e);return w.map(t,function(t){var i=r?e:t[e];return null==i?i:i.apply(t,n)})},w.pluck=function(t,e){return w.map(t,w.property(e))},w.where=function(t,e){return w.filter(t,w.matcher(e))},w.findWhere=function(t,e){return w.find(t,w.matcher(e))},w.max=function(t,e,n){var r,i,o=-(1/0),a=-(1/0);if(null==e&&null!=t){t=T(t)?t:w.values(t);for(var u=0,s=t.length;s>u;u++)r=t[u],r>o&&(o=r)}else e=j(e,n),w.each(t,function(t,n,r){i=e(t,n,r),(i>a||i===-(1/0)&&o===-(1/0))&&(o=t,a=i)});return o},w.min=function(t,e,n){var r,i,o=1/0,a=1/0;if(null==e&&null!=t){t=T(t)?t:w.values(t);for(var u=0,s=t.length;s>u;u++)r=t[u],o>r&&(o=r)}else e=j(e,n),w.each(t,function(t,n,r){i=e(t,n,r),(a>i||i===1/0&&o===1/0)&&(o=t,a=i)});return o},w.shuffle=function(t){for(var e,n=T(t)?t:w.values(t),r=n.length,i=Array(r),o=0;r>o;o++)e=w.random(0,o),e!==o&&(i[o]=i[e]),i[e]=n[o];return i},w.sample=function(t,e,n){return null==e||n?(T(t)||(t=w.values(t)),t[w.random(t.length-1)]):w.shuffle(t).slice(0,Math.max(0,e))},w.sortBy=function(t,e,n){return e=j(e,n),w.pluck(w.map(t,function(t,n,r){return{value:t,index:n,criteria:e(t,n,r)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return t.index-e.index}),"value")};var A=function(t){return function(e,n,r){var i={};return n=j(n,r),w.each(e,function(r,o){var a=n(r,o,e);t(i,r,a)}),i}};w.groupBy=A(function(t,e,n){w.has(t,n)?t[n].push(e):t[n]=[e]}),w.indexBy=A(function(t,e,n){t[n]=e}),w.countBy=A(function(t,e,n){w.has(t,n)?t[n]++:t[n]=1}),w.toArray=function(t){return t?w.isArray(t)?p.call(t):T(t)?w.map(t,w.identity):w.values(t):[]},w.size=function(t){return null==t?0:T(t)?t.length:w.keys(t).length},w.partition=function(t,e,n){e=j(e,n);var r=[],i=[];return w.each(t,function(t,n,o){(e(t,n,o)?r:i).push(t)}),[r,i]},w.first=w.head=w.take=function(t,e,n){return null!=t?null==e||n?t[0]:w.initial(t,t.length-e):void 0},w.initial=function(t,e,n){return p.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},w.last=function(t,e,n){return null!=t?null==e||n?t[t.length-1]:w.rest(t,Math.max(0,t.length-e)):void 0},w.rest=w.tail=w.drop=function(t,e,n){return p.call(t,null==e||n?1:e)},w.compact=function(t){return w.filter(t,w.identity)};var E=function(t,e,n,r){for(var i=[],o=0,a=r||0,u=x(t);u>a;a++){var s=t[a];if(T(s)&&(w.isArray(s)||w.isArguments(s))){e||(s=E(s,e,n));var l=0,c=s.length;for(i.length+=c;c>l;)i[o++]=s[l++]}else n||(i[o++]=s)}return i};w.flatten=function(t,e){return E(t,e,!1)},w.without=function(t){return w.difference(t,p.call(arguments,1))},w.uniq=w.unique=function(t,e,n,r){w.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=j(n,r));for(var i=[],o=[],a=0,u=x(t);u>a;a++){var s=t[a],l=n?n(s,a,t):s;e?(a&&o===l||i.push(s),o=l):n?w.contains(o,l)||(o.push(l),i.push(s)):w.contains(i,s)||i.push(s)}return i},w.union=function(){return w.uniq(E(arguments,!0,!0))},w.intersection=function(t){for(var e=[],n=arguments.length,r=0,i=x(t);i>r;r++){var o=t[r];if(!w.contains(e,o)){for(var a=1;n>a&&w.contains(arguments[a],o);a++);a===n&&e.push(o)}}return e},w.difference=function(t){var e=E(arguments,!0,!0,1);return w.filter(t,function(t){return!w.contains(e,t)})},w.zip=function(){return w.unzip(arguments)},w.unzip=function(t){for(var e=t&&w.max(t,x).length||0,n=Array(e),r=0;e>r;r++)n[r]=w.pluck(t,r);return n},w.object=function(t,e){for(var n={},r=0,i=x(t);i>r;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},w.findIndex=r(1),w.findLastIndex=r(-1),w.sortedIndex=function(t,e,n,r){n=j(n,r,1);for(var i=n(e),o=0,a=x(t);a>o;){var u=Math.floor((o+a)/2);n(t[u])<i?o=u+1:a=u}return o},w.indexOf=i(1,w.findIndex,w.sortedIndex),w.lastIndexOf=i(-1,w.findLastIndex),w.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),o=0;r>o;o++,t+=n)i[o]=t;return i};var M=function(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var o=P(t.prototype),a=t.apply(o,i);return w.isObject(a)?a:o};w.bind=function(t,e){if(g&&t.bind===g)return g.apply(t,p.call(arguments,1));if(!w.isFunction(t))throw new TypeError("Bind must be called on a function");var n=p.call(arguments,2),r=function(){return M(t,r,e,this,n.concat(p.call(arguments)))};return r},w.partial=function(t){var e=p.call(arguments,1),n=function(){for(var r=0,i=e.length,o=Array(i),a=0;i>a;a++)o[a]=e[a]===w?arguments[r++]:e[a];for(;r<arguments.length;)o.push(arguments[r++]);return M(t,n,this,this,o)};return n},w.bindAll=function(t){var e,n,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(e=1;r>e;e++)n=arguments[e],t[n]=w.bind(t[n],t);return t},w.memoize=function(t,e){var n=function(r){var i=n.cache,o=""+(e?e.apply(this,arguments):r);return w.has(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return n.cache={},n},w.delay=function(t,e){var n=p.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},w.defer=w.partial(w.delay,w,1),w.throttle=function(t,e,n){var r,i,o,a=null,u=0;n||(n={});var s=function(){u=n.leading===!1?0:w.now(),a=null,o=t.apply(r,i),a||(r=i=null)};return function(){var l=w.now();u||n.leading!==!1||(u=l);var c=e-(l-u);return r=this,i=arguments,0>=c||c>e?(a&&(clearTimeout(a),a=null),u=l,o=t.apply(r,i),a||(r=i=null)):a||n.trailing===!1||(a=setTimeout(s,c)),o}},w.debounce=function(t,e,n){var r,i,o,a,u,s=function(){var l=w.now()-a;e>l&&l>=0?r=setTimeout(s,e-l):(r=null,n||(u=t.apply(o,i),r||(o=i=null)))};return function(){o=this,i=arguments,a=w.now();var l=n&&!r;return r||(r=setTimeout(s,e)),l&&(u=t.apply(o,i),o=i=null),u}},w.wrap=function(t,e){return w.partial(e,t)},w.negate=function(t){return function(){return!t.apply(this,arguments)}},w.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},w.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},w.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}},w.once=w.partial(w.before,2);var C=!{toString:null}.propertyIsEnumerable("toString"),z=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];w.keys=function(t){if(!w.isObject(t))return[];if(v)return v(t);var e=[];for(var n in t)w.has(t,n)&&e.push(n);return C&&o(t,e),e},w.allKeys=function(t){if(!w.isObject(t))return[];var e=[];for(var n in t)e.push(n);return C&&o(t,e),e},w.values=function(t){for(var e=w.keys(t),n=e.length,r=Array(n),i=0;n>i;i++)r[i]=t[e[i]];return r},w.mapObject=function(t,e,n){e=j(e,n);for(var r,i=w.keys(t),o=i.length,a={},u=0;o>u;u++)r=i[u],a[r]=e(t[r],r,t);return a},w.pairs=function(t){for(var e=w.keys(t),n=e.length,r=Array(n),i=0;n>i;i++)r[i]=[e[i],t[e[i]]];return r},w.invert=function(t){for(var e={},n=w.keys(t),r=0,i=n.length;i>r;r++)e[t[n[r]]]=n[r];return e},w.functions=w.methods=function(t){var e=[];for(var n in t)w.isFunction(t[n])&&e.push(n);return e.sort()},w.extend=O(w.allKeys),w.extendOwn=w.assign=O(w.keys),w.findKey=function(t,e,n){e=j(e,n);for(var r,i=w.keys(t),o=0,a=i.length;a>o;o++)if(r=i[o],e(t[r],r,t))return r},w.pick=function(t,e,n){var r,i,o={},a=t;if(null==a)return o;w.isFunction(e)?(i=w.allKeys(a),r=S(e,n)):(i=E(arguments,!1,!1,1),r=function(t,e,n){return e in n},a=Object(a));for(var u=0,s=i.length;s>u;u++){var l=i[u],c=a[l];r(c,l,a)&&(o[l]=c)}return o},w.omit=function(t,e,n){if(w.isFunction(e))e=w.negate(e);else{var r=w.map(E(arguments,!1,!1,1),String);e=function(t,e){return!w.contains(r,e)}}return w.pick(t,e,n)},w.defaults=O(w.allKeys,!0),w.create=function(t,e){var n=P(t);return e&&w.extendOwn(n,e),n},w.clone=function(t){return w.isObject(t)?w.isArray(t)?t.slice():w.extend({},t):t},w.tap=function(t,e){return e(t),t},w.isMatch=function(t,e){var n=w.keys(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;r>o;o++){var a=n[o];if(e[a]!==i[a]||!(a in i))return!1}return!0};var I=function(t,e,n,r){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof w&&(t=t._wrapped),e instanceof w&&(e=e._wrapped);var i=h.call(t);if(i!==h.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,u=e.constructor;if(a!==u&&!(w.isFunction(a)&&a instanceof a&&w.isFunction(u)&&u instanceof u)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],r=r||[];for(var s=n.length;s--;)if(n[s]===t)return r[s]===e;if(n.push(t),r.push(e),o){if(s=t.length,s!==e.length)return!1;for(;s--;)if(!I(t[s],e[s],n,r))return!1}else{var l,c=w.keys(t);if(s=c.length,w.keys(e).length!==s)return!1;for(;s--;)if(l=c[s],!w.has(e,l)||!I(t[l],e[l],n,r))return!1}return n.pop(),r.pop(),!0};w.isEqual=function(t,e){return I(t,e)},w.isEmpty=function(t){return null==t?!0:T(t)&&(w.isArray(t)||w.isString(t)||w.isArguments(t))?0===t.length:0===w.keys(t).length},w.isElement=function(t){return!(!t||1!==t.nodeType)},w.isArray=y||function(t){return"[object Array]"===h.call(t)},w.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},w.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){w["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}}),w.isArguments(arguments)||(w.isArguments=function(t){return w.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(w.isFunction=function(t){return"function"==typeof t||!1}),w.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},w.isNaN=function(t){return w.isNumber(t)&&t!==+t},w.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===h.call(t)},w.isNull=function(t){return null===t},w.isUndefined=function(t){return void 0===t},w.has=function(t,e){return null!=t&&d.call(t,e)},w.noConflict=function(){return a._=u,this},w.identity=function(t){return t},w.constant=function(t){return function(){return t}},w.noop=function(){},w.property=_,w.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},w.matcher=w.matches=function(t){return t=w.extendOwn({},t),function(e){return w.isMatch(e,t)}},w.times=function(t,e,n){var r=Array(Math.max(0,t));e=S(e,n,1);for(var i=0;t>i;i++)r[i]=e(i);return r},w.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},w.now=Date.now||function(){return(new Date).getTime()};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},D=w.invert(B),X=function(t){var e=function(e){return t[e]},n="(?:"+w.keys(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}};w.escape=X(B),w.unescape=X(D),w.result=function(t,e,n){var r=null==t?void 0:t[e];return void 0===r&&(r=n),w.isFunction(r)?r.call(t):r};var Y=0;w.uniqueId=function(t){var e=++Y+"";return t?t+e:e},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\u2028|\u2029/g,R=function(t){return"\\"+F[t]};w.template=function(t,e,n){!e&&n&&(e=n),e=w.defaults({},e,w.templateSettings);var r=RegExp([(e.escape||L).source,(e.interpolate||L).source,(e.evaluate||L).source].join("|")+"|$","g"),i=0,o="__p+='";t.replace(r,function(e,n,r,a,u){return o+=t.slice(i,u).replace(N,R),i=u+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var a=new Function(e.variable||"obj","_",o)}catch(u){throw u.source=o,u}var s=function(t){return a.call(this,t,w)},l=e.variable||"obj";return s.source="function("+l+"){\n"+o+"}",s},w.chain=function(t){var e=w(t);return e._chain=!0,e};var U=function(t,e){return t._chain?w(e).chain():e};w.mixin=function(t){w.each(w.functions(t),function(e){var n=w[e]=t[e];w.prototype[e]=function(){var t=[this._wrapped];return f.apply(t,arguments),U(this,n.apply(w,t))}})},w.mixin(w),w.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=s[t];w.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],U(this,n)}}),w.each(["concat","join","slice"],function(t){var e=s[t];w.prototype[t]=function(){return U(this,e.apply(this._wrapped,arguments))}}),w.prototype.value=function(){return this._wrapped},w.prototype.valueOf=w.prototype.toJSON=w.prototype.value,w.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return w})}).call(this)},{}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={};n["default"]=r;var i=function(t,e){for(var n in t)e[n]=t[n]},o=(n.configForPlayers=function(t){t>=4?i(o,r):3==t?i(a,r):i(u,r),console.log("init consts",r)},{Size:32,StartHealth:64,SizeX:14,SizeY:9,ScaleX:2,ScaleY:2,StartingPositions:[{x:2,y:2},{x:12,y:7},{x:12,y:2},{x:2,y:7}]}),a=(n.Colors=[{colorStr:"#12fe00",colorNum:1244672},{colorStr:"#fff859",colorNum:16775257},{colorStr:"#0decfe",colorNum:912638},{colorStr:"#fe544f",colorNum:16667727}],{Size:32,StartHealth:64,SizeX:11,SizeY:9,ScaleX:2,ScaleY:2,StartingPositions:[{x:1,y:4},{x:6,y:4},{x:9,y:4}]}),u={Size:32,StartHealth:64,SizeX:9,SizeY:7,ScaleX:2,ScaleY:2,StartingPositions:[{x:1,y:3},{x:8,y:3}]}},{}],3:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("states/GameState"),l=r(s),c=t("states/MenuState"),f=r(c),p=t("states/LoadingScreen"),h=r(p),d=t("states/EndState"),y=r(d),v=(t("underscore"),function(t){function e(){i(this,e);var t=o(this,Object.getPrototypeOf(e).call(this,960,640,Phaser.AUTO,"content",null,!1,!1));return t.state.add("LoadingScreen",h["default"],!1),t.state.add("MenuState",f["default"],!1),t.state.add("GameState",l["default"],!1),t.state.add("EndState",y["default"],!1),t.players=[],t.state.start("LoadingScreen"),t}return a(e,t),u(e,[{key:"create",value:function(){console.log("game create"),this.stage.backgroundColor="#ff00ff"}}]),e}(Phaser.Game));new v},{"states/EndState":11,"states/GameState":12,"states/LoadingScreen":13,"states/MenuState":14,underscore:1}],4:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t){function e(t,n,o,a,u,s,l,c,f){r(this,e);var p=i(this,Object.getPrototypeOf(e).call(this,t,n,o,a,u,s,l,c,f));return t.add.existing(p),p}return o(e,t),a(e,[{key:"addText",value:function(t,e){var n=new Phaser.Text(this.game,0,0,t,{font:e+"px Arial",fill:"#ffffff"});this.addChild(n)}}]),e}(Phaser.Button);n["default"]=u},{}],5:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("objects/Tile.js"),l=r(s),c=function(t){function e(t,n,r){i(this,e);var a=o(this,Object.getPrototypeOf(e).call(this,t));a.xSize=n,a.ySize=r;var u=0;return a.mapData=Array.apply(null,Array(n*r)).map(function(e){var r=new l["default"](t,u%n,Math.floor(u/n));return u++,r}),console.log(a.mapData),a.mapData.forEach(function(t){a.addChild(t)}),a}return a(e,t),u(e,[{key:"tileAt",value:function(t,e){return this.mapData[e*this.xSize+t]}},{key:"increaseScores",value:function(){for(var t=0;t<this.mapData.length;++t){var e=this.mapData[t];e.isFree()||e.grow(1)}}},{key:"scores",value:function(t){var e=new Map,n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value;e.set(u,0)}}catch(s){r=!0,i=s}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}for(var l=0;l<this.mapData.length;++l){var c=this.mapData[l];if(!c.isFree()){var f=c.player,p=e.get(f)+c.health;e.set(f,p)}}return e}}]),e}(Phaser.Group);n["default"]=c},{"objects/Tile.js":9}],6:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(t){function e(t,n,o){return r(this,e),i(this,Object.getPrototypeOf(e).call(this,t))}return o(e,t),e}(Phaser.Stage);n["default"]=a},{}],7:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.PlayerInfo=void 0;var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("consts/MapConsts.js"),l=r(s),c=(n.PlayerInfo=function(){function t(e,n,r){a(this,t),this.padId=e,this.id=n,this.padMap=r}return u(t,[{key:"color",get:function(){return this.colorNum}},{key:"colorNum",get:function(){return s.Colors[this.id].colorNum}},{key:"colorStr",get:function(){return s.Colors[this.id].colorStr}}]),t}(),function(t){function e(t,n,r,o,u){a(this,e);var s=i(this,Object.getPrototypeOf(e).call(this,t));return s.callbacks=u||{},s.callbacks.doDivide||(s.callbacks.doDivide=function(t,e,n){}),s.callbacks.context||(s.callbacks.context={}),s.info=n,s.tilePosX=r,s.tilePosY=o,s.updateSprites(),s.sprite=new Phaser.Sprite(t,0,0,"cursor"),s.sprite.tint=n.color,s.sprite.animations.add("cycle"),s.sprite.animations.play("cycle",8,!0),s.addChild(s.sprite),s.pad.addCallbacks(s,{onDown:s.handlePadDown,onUp:s.handlePadUp}),s.actionPressed=!1,s.moveActions={up:s.moveUp,down:s.moveDown,left:s.moveLeft,right:s.moveRight},s.divideActions={up:s.divideUp,down:s.divideDown,left:s.divideLeft,right:s.divideRight},s}return o(e,t),u(e,[{key:"unregisterCallbacks",value:function(){this.pad.onUpCallback=null,this.pad.onDownCallback=null}},{key:"handlePadDown",value:function(t){var e=this.info.padMap[t];if(console.log("button pressed",e,"action pressed:"+this.actionPressed),"action"==e&&(this.actionPressed=!0),"dash"==e&&(this.dashPressed=!0),this.moveActions[e]){if(this.dashPressed)return this.divideActions[e].call(this),void this.moveActions[e].call(this);this.actionPressed?this.divideActions[e].call(this):this.moveActions[e].call(this)}}},{key:"handlePadUp",value:function(t){var e=this.info.padMap[t];"action"==e&&(this.actionPressed=!1),"dash"==e&&(this.dashPressed=!1)}},{key:"moveUp",value:function(){var t=this;console.log("UP!");var e=this.game.add.tween(this).to({y:(l["default"].SizeY+this.tilePosY-1)%l["default"].SizeY*l["default"].Size},50,"Linear",!0,0);e.onComplete.add(function(){t.tilePosY=(l["default"].SizeY+t.tilePosY-1)%l["default"].SizeY},this)}},{key:"moveDown",value:function(){var t=this,e=this.game.add.tween(this).to({y:(l["default"].SizeY+this.tilePosY+1)%l["default"].SizeY*l["default"].Size},50,"Linear",!0,0);e.onComplete.add(function(){t.tilePosY=(l["default"].SizeY+t.tilePosY+1)%l["default"].SizeY},this)}},{key:"moveLeft",value:function(){var t=this,e=this.game.add.tween(this).to({x:(l["default"].SizeX+this.tilePosX-1)%l["default"].SizeX*l["default"].Size},50,"Linear",!0,0);e.onComplete.add(function(){t.tilePosX=(l["default"].SizeX+t.tilePosX-1)%l["default"].SizeX},this)}},{key:"moveRight",value:function(){var t=this,e=this.game.add.tween(this).to({x:(l["default"].SizeX+this.tilePosX+1)%l["default"].SizeX*l["default"].Size},50,"Linear",!0,0);e.onComplete.add(function(){t.tilePosX=(l["default"].SizeX+t.tilePosX+1)%l["default"].SizeX},this)}},{key:"divideTo",value:function(t,e){console.log("divide"),this.callbacks.doDivide.call(this.callbacks.context,this,t,e)}},{key:"divideUp",value:function(){var t=this.tilePosX,e=this.tilePosY-1;e>=0&&this.divideTo(t,e)}},{key:"divideDown",value:function(){var t=this.tilePosX,e=this.tilePosY+1;e<l["default"].SizeY&&this.divideTo(t,e)}},{key:"divideLeft",value:function(){var t=this.tilePosX-1,e=this.tilePosY;t>=0&&this.divideTo(t,e)}},{key:"divideRight",value:function(){var t=this.tilePosX+1,e=this.tilePosY;t<l["default"].SizeX&&this.divideTo(t,e)}},{key:"ownsTile",value:function(t){return t.player===this}},{key:"updateSprites",value:function(){this.position.set(this.tilePosX*l["default"].Size,this.tilePosY*l["default"].Size)}},{key:"update",value:function(){}},{key:"pad",get:function(){return this.game.input.gamepad[this.info.padId]}}]),e}(Phaser.Group));n["default"]=c},{"consts/MapConsts.js":2}],8:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("consts/MapConsts"),l=(r(s),function(t){function e(t,n,r,a){i(this,e);var u=o(this,Object.getPrototypeOf(e).call(this,t));u.sprite=new Phaser.Sprite(t,n,r,a),t.add.existing(u);var l=[];l[0]=u.game.add.bitmapText(142,12,"font","0",24),l[1]=u.game.add.bitmapText(302,12,"font","0",24),l[2]=u.game.add.bitmapText(558,12,"font","0",24),l[3]=u.game.add.bitmapText(718,12,"font","0",24);var c=!0,f=!1,p=void 0;try{for(var h,d=l[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var y=h.value;u.addChild(y)}}catch(v){f=!0,p=v}finally{try{!c&&d["return"]&&d["return"]()}finally{if(f)throw p}}var g=[];g.push(new Phaser.Sprite(t,190,6,"pad")),g.push(new Phaser.Sprite(t,350,6,"pad")),g.push(new Phaser.Sprite(t,606,6,"pad")),g.push(new Phaser.Sprite(t,766,6,"pad"));var b=0,m=!0,w=!1,S=void 0;try{for(var j,O=g[Symbol.iterator]();!(m=(j=O.next()).done);m=!0){var P=j.value;u.addChild(P),P.tint=s.Colors[b].colorNum,b++}}catch(v){w=!0,S=v}finally{try{!m&&O["return"]&&O["return"]()}finally{if(w)throw S}}return u}return a(e,t),u(e,[{key:"changeScore",value:function(t,e){var n=t.info.id,r=this.getChildAt(n);r.text=e,this.removeChildAt(n),this.addChildAt(r,n)}}]),e}(Phaser.Sprite));n["default"]=l},{"consts/MapConsts":2}],9:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("consts/MapConsts"),l=r(s),c=function(t){function e(t,n,r){i(this,e);var a=o(this,Object.getPrototypeOf(e).call(this,t));return a.sprite=new Phaser.Sprite(a.game,n*l["default"].Size,r*l["default"].Size,"tile"),a.addChild(a.sprite),a.healthText=new Phaser.BitmapText(a.game,4,8,"font","",16),a.sprite.addChild(a.healthText),a.player=null,a.health=0,a.updateSprite(),a}return a(e,t),u(e,[{key:"isHabitable",value:function(){return!0}},{key:"isFree",value:function(){return null==this.player}},{key:"populate",value:function(t,e){t!=this.player&&(this.health=0),this.player=t,this.health+=e,this.updateSprite()}},{key:"grow",value:function(t){null!=this.player&&(this.health+=t,this.updateSprite())}},{key:"depopulate",value:function(t){this.health=Math.max(0,this.health-t),0===this.health&&(this.player=null),this.updateSprite()}},{key:"updateSprite",value:function(){null!==this.player&&(this.sprite.tint=this.player.info.colorNum,this.healthText.text=this.health)}}]),e}(Phaser.Group);n["default"]=c},{"consts/MapConsts":2}],10:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){
if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t){function e(t,n,o,a){r(this,e);var u=i(this,Object.getPrototypeOf(e).call(this,t));u.sprite=new Phaser.Sprite(t,n,o,a),t.add.existing(u);var s=u.game.add.bitmapText(456,8,"font","99",38);return u.addChild(s),u}return o(e,t),a(e,[{key:"changeTimer",value:function(t){this.removeChildren();var e=this.game.add.bitmapText(456,8,"font",t,38);this.addChild(e)}}]),e}(Phaser.Sprite);n["default"]=u},{}],11:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("underscore"),l=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"setScore",value:function(t){this.score=t}},{key:"create",value:function(){void 0===this.score&&(this.score=new Map,this.score.set({info:{id:0,colorStr:"#12fe00"}},200),this.score.set({info:{id:1,colorStr:"#fff859"}},175),this.score.set({info:{id:2,colorStr:"#0decfe"}},80),this.score.set({info:{id:3,colorStr:"#fe544f"}},300)),console.log("EndState:"),this.game.add.sprite(0,0,"bgEnd");var t={x:this.game.world.centerX,y:this.game.world.centerY},e=Math.max.apply(null,Array.from(this.score.values()));console.log(e);Array.prototype.filter.call(Array.from(this.score.entries()),function(t){var n=a(t,2),r=(n[0],n[1]);return r==e});this.game.input.gamepad.start(),this.game.input.gamepad.addCallbacks(this,{onDown:this.padDownEvent});var n=1,r=s.sortBy(Array.from(this.score.entries()),function(t){return-t[1]});this.game.add.bitmapText(t.x-125,t.y-245,"font","SCORES:",60);var i=!0,o=!1,u=void 0;try{for(var l,c=r[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var f=a(l.value,2),p=f[0],h=f[1],d=this.game.add.bitmapText(t.x-350,t.y-195+70*n,"font","Player "+(p.info.id+1)+" score: "+h,48);d.tint="0x"+p.info.colorStr.replace("#",""),n++}}catch(y){o=!0,u=y}finally{try{!i&&c["return"]&&c["return"]()}finally{if(o)throw u}}this.game.add.bitmapText(t.x-350,t.y+200,"font","Player 1 hit action button to replay!",36)}},{key:"rematch",value:function(){window.location.reload(!1)}},{key:"padDownEvent",value:function(t){var e=this,n=this.game.players[0].padId,r=this.game.players[0].padMap,i=this.game.input.gamepad[n];i.addCallbacks(this,{onDown:function(t){"action"===r[t]&&e.rematch()}})}}]),e}(Phaser.State);n["default"]=l},{underscore:1}],12:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=t("objects/Grid"),c=(r(l),t("consts/MapConsts")),f=r(c),p=t("objects/GameMap"),h=r(p),d=t("objects/ScoreTable"),y=r(d),v=t("objects/Player"),g=r(v),b=t("objects/Timer"),m=r(b),w=function(t){function e(){return i(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return a(e,t),s(e,[{key:"create",value:function(){(0,c.configForPlayers)(this.game.players.length),this.game.add.image(0,0,"bgFrame"),this.playerObjects=[],this.countdown=99,this.createMap();for(var t=0;t<this.game.players.length;++t)this.addPlayerByInfo(this.game.players[t]);this.timerLabel=new m["default"](this.game,200,200,"timer"),this.timerStart(),this.scoreTable=new y["default"](this.game,300,300,"scoreTable"),this.attackSound=this.game.add.audio("attackSound"),this.divideSound=this.game.add.audio("divideSound")}},{key:"createMap",value:function(){this.mapa=new h["default"](this.game,f["default"].SizeX,f["default"].SizeY),this.mapa.scale.set(2,2);var t=(this.game.width-f["default"].SizeX*f["default"].Size*2)/2;this.mapa.x=Math.floor(t);var e=(this.game.height-50-f["default"].SizeY*f["default"].Size*2)/2;this.mapa.y=50+Math.floor(e)}},{key:"addPlayerByInfo",value:function(t){var e=this,n=t.id,r=f["default"].StartingPositions[n],i=new g["default"](this.game,t,r.x,r.y,{doDivide:function(t,n,r){e.divideInto(t,n,r)}}),o=this.playerTile(i);this.mapa.addChild(i),o.populate(i,f["default"].StartHealth),this.playerObjects.push(i)}},{key:"timerStart",value:function(){var t=this.game.time.create(!1);t.loop(1e3,this.updateTimer,this),t.start()}},{key:"updateTimer",value:function(){this.countdown--,console.log("Timer: "+this.countdown),this.timerLabel.changeTimer(this.countdown),this.countdown&&this.countdown%5==0&&this.mapa.increaseScores();var t=this.mapa.scores(this.playerObjects),e=!0,n=!1,r=void 0;try{for(var i,o=t.entries()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=u(i.value,2),s=a[0],l=a[1];this.scoreTable.changeScore(s,l)}}catch(c){n=!0,r=c}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}0!=this.countdown&&1!=Array.from(t.entries()).length||this.finishGame(t)}},{key:"finishGame",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.playerObjects[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;a.unregisterCallbacks()}}catch(u){n=!0,r=u}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}this.game.state.states.EndState.setScore(t),this.game.state.start("EndState")}},{key:"tileAt",value:function(t,e){return this.mapa.tileAt(t,e)}},{key:"playerTile",value:function(t){return this.tileAt(t.tilePosX,t.tilePosY)}},{key:"divideInto",value:function(t,e,n){console.log("divide start");var r=this.playerTile(t);if(r.player===t){var i=this.tileAt(e,n);if(i.isHabitable()){var o=Math.floor(r.health/2);if(0!=o)if(console.log("divide:",o),i.isFree()||t.ownsTile(i))r.depopulate(o),i.populate(t,o),this.playDivideSound();else{var a=Math.min(i.health,o);if(r.depopulate(o),i.depopulate(a),a>=i.health){var u=o-Math.ceil(a/2);u>0&&i.populate(t,u)}this.playAttackSound()}}}}},{key:"playDivideSound",value:function(){this.divideSound.play()}},{key:"playAttackSound",value:function(){this.attackSound.play()}}]),e}(Phaser.State);n["default"]=w},{"consts/MapConsts":2,"objects/GameMap":5,"objects/Grid":6,"objects/Player":7,"objects/ScoreTable":8,"objects/Timer":10}],13:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),a(e,[{key:"preload",value:function(){this.barLoaded=!1,this.load.image("loading-logo","assets/loading/load-logo.png"),this.load.image("loading-bar","assets/loading/bar.png"),this.load.addSyncPoint("image","loading-bar"),this.load.onFileComplete.add(this.afterLoaded,this),this.load.image("loading-2","assets/loading/2.png"),this.game.load.tilemap("myTileMap","assets/level11.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.image("tiles","assets/tileset.png"),this.game.load.image("tile","assets/tile.png"),this.load.spritesheet("cursor","assets/cursor.png",32,32,4),this.load.bitmapFont("font","assets/04B_03___0.png","assets/04B_03__.xml"),this.game.load.audio("themeAudio","assets/audio/themeAudio.mp3"),this.game.load.audio("attackSound","assets/audio/attackSound.wav"),this.game.load.audio("divideSound","assets/audio/divideSound.wav"),this.game.load.audio("powerUpSound","assets/audio/powerUpSound.wav"),this.game.load.spritesheet("colorButtons","assets/colorButtonSpritesheet.png",64,64),this.game.load.spritesheet("startGameSpritesheet","assets/startGameSpritesheet.png",248,64),this.game.load.image("bg","assets/bgEnd.png"),this.game.load.image("bgFrame","assets/bgFrame.png"),this.load.image("bgEnd","assets/bgEnd.png"),this.game.load.image("pad","assets/pad.png")}},{key:"afterLoaded",value:function(){var t={"loading-logo":this.afterLogoLoaded,"loading-bar":this.afterBarLoaded};t[arguments[1]]&&t[arguments[1]].call(this)}},{key:"afterLogoLoaded",value:function(){this.logo=this.game.add.image(this.game.width/2,this.game.height/2,"loading-logo"),this.logo.anchor.setTo(.5)}},{key:"afterBarLoaded",value:function(){this.origWidth=this.cache.getImage("loading-bar").width,this.bar=this.game.add.image(this.game.width/2-this.origWidth/2,this.game.height/2+this.logo.height,"loading-bar"),this.cropRect=new Phaser.Rectangle(0,0,0,this.bar.height),this.bar.crop(this.cropRect),this.barLoaded=!0}},{key:"loadUpdate",value:function(){this.barLoaded&&this.barUpdate(this.load.progress)}},{key:"barUpdate",value:function(t){this.cropRect.width=t*this.origWidth/100,this.bar.crop(this.cropRect)}},{key:"create",value:function(){var t=this.game.add.audio("themeAudio");t.loopFull(.6),this.barUpdate(100),this.state.start("MenuState")}}]),e}(Phaser.State);n["default"]=u},{}],14:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("objects/Button"),l=(r(s),t("objects/Player")),c=(r(l),function(t){function e(){return i(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return a(e,t),u(e,[{key:"create",value:function(){var t=this;this.game.add.image(0,0,"bg");var e={x:this.game.world.centerX,y:this.game.world.centerY};this.game.add.button(e.x-32,e.y+225,"colorButtons",function(){t.clearSettings(),t.saveSettings()},this,2,2,1,2);this.playersColors=["0x12fe00","0xfff859","0x0decfe","0xfe544f"],this.buttons=["any","up","down","left","right","action","dash"],this.playerText={},this.isActive=[!1,!1,!1,!1],this.game.input.gamepad.start(),this.game.input.gamepad.addCallbacks(this,{onDown:this.padDownEvent});var n=this.game.add.bitmapText(this.game.world.centerX,48,"font","Total",72);n.anchor.setTo(.5);var r=this.game.add.bitmapText(this.game.world.centerX,116,"font","Kwadracik",72);r.anchor.setTo(.5);var i=this.game.add.bitmapText(this.game.world.centerX,184,"font","Anihillation",72);i.anchor.setTo(.5),this.clearSettings(),this.loadSettings()}},{key:"update",value:function(){}},{key:"playerInfoArray",value:function(){for(var t=[],e=0;e<this.playerz.length;++e)this.isActive[e]&&t.push(this.playerz[e]);return t}},{key:"playerSettingsArray",value:function(){for(var t=[],e=0;e<this.playerz.length;++e)this.playerButtonId[e]==this.buttons.length&&t.push(this.playerz[e]);return t}},{key:"saveSettings",value:function(){"undefined"!=typeof Storage&&(localStorage.setItem("players",JSON.stringify(this.playerSettingsArray())),console.log("Saved players:"),console.log(this.playerSettingsArray()))}},{key:"loadSettings",value:function(){if("undefined"!=typeof Storage){this.playerz.length=0;var t=JSON.parse(localStorage.getItem("players"));if(null!=t){for(var e=0;e<t.length;++e)t[e].id=e,this.playerButtonId[e]=this.buttons.length,this.playerNums++,this.playerz[e]=new l.PlayerInfo(t[e].padId,t[e].id,t[e].padMap),this.registerButtonCallback(t[e],e);console.log("Loaded players."),console.log(this.playerSettingsArray())}}}},{key:"clearSettings",value:function(){this.playerz=[],this.playerNums=0,this.playerButtonId={},this.playerButtons=[];for(var t=0;4>t;++t){var e=this.playersColors[t];void 0===this.playerText[t]?(this.playerText[t]=this.game.add.bitmapText(128,266+70*t,"font","player"+(t+1)+" - press any button to join",32),this.playerText[t].tint=e):this.playerText[t].text="player"+(t+1)+" - press any button to join",this.playerButtons[t]=this.add.sprite(32,250+70*t,"colorButtons",2),this.playerButtons[t].tint=e}this.clearCallbacks()}},{key:"clearCallbacks",value:function(){for(var t=0;t<this.playerz.length;++t){var e=this.game.input.gamepad[this.playerz[t].padId];e&&(e.onDownCallback=null)}}},{key:"addPlayer",value:function(t){console.log("pad connected ",t)}},{key:"registerButtonCallback",value:function(t,e){var n=this,r=this.game.input.gamepad[t.padId];r.addCallbacks(this,{onDown:function(r){if(n.playerButtonId[e]<n.buttons.length){var i=n.buttons[n.playerButtonId[e]];if("any"!==i){if(t.padMap[r])return;t.padMap[r]=i}n.playerButtonId[e]++,n.playerButtonId[e]>=n.buttons.length?n.playerText[e].text="ready?":n.playerText[e].text=n.buttons[n.playerButtonId[e]]}else 0==e&&n.isActive[0]?(n.clearCallbacks(),n.game.players=n.playerInfoArray(),n.game.state.start("GameState")):n.isActive[e]||(n.playerText[e].text=0==e?"press 'action' to begin":"ready!",n.isActive[e]=!0,n.playerButtons[e].frame=1,n.saveSettings());console.log(t.padMap)}})}},{key:"padDownEvent",value:function(t,e,n){for(var r="pad"+(n+1),i=0;i<this.playerz.length;++i)if(this.playerz[i].padId==r)return;console.log("new player");var o=this.playerNums;this.playerz[o]=new l.PlayerInfo(r,o,{}),this.playerButtonId[o]=0,this.playerNums++,this.registerButtonCallback(this.playerz[o],o)}}]),e}(Phaser.State));n["default"]=c},{"objects/Button":4,"objects/Player":7}]},{},[3]);